@prefix : <http://example.org/ffdr#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/2001/XMLSchema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix odrl: <http://www.w3.org/ns/odrl/2/> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix vann: <http://purl.org/vocab/vann/> .
@base <http://example.org/ffdr> .

<http://example.org/ffdr> rdf:type owl:Ontology ;
    dct:title "Free Flow Data Restrictions (FFDR) Ontology"@en ;
    dct:description """An ontology for detecting and representing data localisation restrictions 
    in ODRL policies with respect to EU Regulation 2018/1807 on the free flow of non-personal data."""@en ;
    dct:created "2025-11-18"^^xsd:date ;
    dct:creator "HARNESS-FF Project" ;
    owl:versionInfo "1.0" ;
    vann:preferredNamespacePrefix "ffdr" ;
    vann:preferredNamespaceUri "http://example.org/ffdr#" ;
    rdfs:comment """This ontology supports automated compliance checking of data usage policies 
    against Article 4 of Regulation (EU) 2018/1807, which prohibits data localisation requirements 
    unless justified on grounds of public security.
    
    The ontology is organized into three conceptual modules using SKOS Collections:
    - Core Module: Essential classes for basic Article 4 compliance detection (5 classes, 8 properties)
    - Extended Module: Rich metadata for provenance and detailed classification (6 classes, 7 properties)  
    - Integration Module: Links to external vocabularies like ODRL and PROV-O (3 classes, 5 properties)"""@en .

#################################################################
#    SKOS Collections - Modular Organization
#################################################################

###  Core Module Collection
:CoreModule rdf:type skos:Collection ;
    skos:prefLabel "Core FFDR Module"@en ;
    skos:definition """Minimal set of classes and properties required for basic Article 4 
    compliance detection. This module provides sufficient functionality for simple deployment 
    scenarios where only violation detection is needed. Consists of 5 classes and 8 properties."""@en ;
    skos:note """Use Case: Quick compliance checks on ODRL policies in data portals. 
    Detects whether a policy restricts data to specific EU member states."""@en ;
    skos:member :LocalisationRestriction ,
                :ComplianceEvaluation ,
                :PolicyViolation ,
                :EUMemberState ,
                :Article4 ,
                # Core properties
                :detectedIn ,
                :restrictsToMemberState ,
                :evaluatedPolicy ,
                :foundViolation ,
                :violatesArticle ,
                :complianceStatus ,
                :restrictionType ,
                :justificationRequired .

###  Extended Module Collection  
:ExtendedModule rdf:type skos:Collection ;
    skos:prefLabel "Extended FFDR Module"@en ;
    skos:definition """Additional classes supporting rich provenance tracking, detailed 
    restriction type classification, and justification documentation. Enables comprehensive 
    reporting and audit trails. Consists of 6 classes and 7 properties."""@en ;
    skos:note """Use Case: Production data spaces requiring detailed compliance reports, 
    provenance tracking, and integration with governance frameworks (GAIA-X, IDSA)."""@en ;
    skos:member :StorageRestriction ,
                :ProcessingRestriction ,
                :AccessRestriction ,
                :PublicSecurityJustification ,
                :GeographicReference ,
                :CanonicalLocation ,
                # Extended properties
                :hasJustification ,
                :normalizedAs ,
                :originalValue ,
                :confidenceScore ,
                :detectionMethod ,
                :violationSeverity ,
                :evaluationTimestamp .

###  Integration Module Collection
:IntegrationModule rdf:type skos:Collection ;
    skos:prefLabel "Integration Module"@en ;
    skos:definition """Classes and properties for linking FFDR to external vocabularies 
    (ODRL, PROV-O, DCT) and supporting interoperability with broader semantic web 
    infrastructure. Consists of 3 classes and 5 properties."""@en ;
    skos:note """Use Case: Linking compliance evaluations to policy documents, integrating 
    with existing provenance systems, and enabling SPARQL federation across data catalogs."""@en ;
    skos:member :RegulatoryArticle ,
                :Justification ,
                :Article4Violation ,
                # Integration properties  
                :restrictsToLocation ,
                :foundRestriction ,
                :violationDescription ,
                :iso3166Alpha2 ,
                :iso3166Alpha3 .

#################################################################
#    Object Properties
#################################################################

###  http://example.org/ffdr#detectedIn
:detectedIn rdf:type owl:ObjectProperty ;
    rdfs:domain :LocalisationRestriction ;
    rdfs:range odrl:Constraint ;
    rdfs:label "detected in"@en ;
    rdfs:comment "Links a localisation restriction to the specific ODRL constraint where it was detected."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#restrictsToLocation
:restrictsToLocation rdf:type owl:ObjectProperty ;
    rdfs:domain :LocalisationRestriction ;
    rdfs:range :GeographicReference ;
    rdfs:label "restricts to location"@en ;
    rdfs:comment "Indicates the geographic location to which data is restricted."@en ;
    skos:scopeNote "Integration property"@en .

###  http://example.org/ffdr#restrictsToMemberState
:restrictsToMemberState rdf:type owl:ObjectProperty ;
    rdfs:subPropertyOf :restrictsToLocation ;
    rdfs:range :EUMemberState ;
    rdfs:label "restricts to member state"@en ;
    rdfs:comment "Indicates restriction to a specific EU member state (Article 4 concern)."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#evaluatedPolicy
:evaluatedPolicy rdf:type owl:ObjectProperty ;
    rdfs:domain :ComplianceEvaluation ;
    rdfs:range odrl:Policy ;
    rdfs:label "evaluated policy"@en ;
    rdfs:comment "The ODRL policy that was evaluated for compliance."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#foundViolation
:foundViolation rdf:type owl:ObjectProperty ;
    rdfs:domain :ComplianceEvaluation ;
    rdfs:range :PolicyViolation ;
    rdfs:label "found violation"@en ;
    rdfs:comment "Links an evaluation to a detected policy violation."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#foundRestriction
:foundRestriction rdf:type owl:ObjectProperty ;
    rdfs:domain :ComplianceEvaluation ;
    rdfs:range :LocalisationRestriction ;
    rdfs:label "found restriction"@en ;
    rdfs:comment "Links an evaluation to a detected localisation restriction."@en ;
    skos:scopeNote "Integration property"@en .

###  http://example.org/ffdr#violatesArticle
:violatesArticle rdf:type owl:ObjectProperty ;
    rdfs:domain :PolicyViolation ;
    rdfs:range :RegulatoryArticle ;
    rdfs:label "violates article"@en ;
    rdfs:comment "Indicates which regulatory article is violated."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#normalizedAs
:normalizedAs rdf:type owl:ObjectProperty ;
    rdfs:domain :GeographicReference ;
    rdfs:range :CanonicalLocation ;
    rdfs:label "normalized as"@en ;
    rdfs:comment "Links a geographic reference to its canonical normalized form."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#hasJustification
:hasJustification rdf:type owl:ObjectProperty ;
    rdfs:domain :LocalisationRestriction ;
    rdfs:range :Justification ;
    rdfs:label "has justification"@en ;
    rdfs:comment "Links a restriction to its legal justification (if any)."@en ;
    skos:scopeNote "Extended property"@en .

#################################################################
#    Data properties
#################################################################

###  http://example.org/ffdr#restrictionType
:restrictionType rdf:type owl:DatatypeProperty ;
    rdfs:domain :LocalisationRestriction ;
    rdfs:range xsd:string ;
    rdfs:label "restriction type"@en ;
    rdfs:comment "Type of restriction: storage, processing, or access."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#complianceStatus
:complianceStatus rdf:type owl:DatatypeProperty ;
    rdfs:domain :ComplianceEvaluation ;
    rdfs:range xsd:string ;
    rdfs:label "compliance status"@en ;
    rdfs:comment "Overall compliance status: compliant, non-compliant, or requires-review."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#justificationRequired
:justificationRequired rdf:type owl:DatatypeProperty ;
    rdfs:domain :LocalisationRestriction ;
    rdfs:range xsd:boolean ;
    rdfs:label "justification required"@en ;
    rdfs:comment "Boolean flag indicating if public security justification is required."@en ;
    skos:scopeNote "Core property"@en .

###  http://example.org/ffdr#confidenceScore
:confidenceScore rdf:type owl:DatatypeProperty ;
    rdfs:range xsd:decimal ;
    rdfs:label "confidence score"@en ;
    rdfs:comment "Confidence level of the detection (0.0 to 1.0)."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#detectionMethod
:detectionMethod rdf:type owl:DatatypeProperty ;
    rdfs:range xsd:string ;
    rdfs:label "detection method"@en ;
    rdfs:comment "Method used to detect the restriction: uri-match, iso-code, string-match, fuzzy."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#evaluationTimestamp
:evaluationTimestamp rdf:type owl:DatatypeProperty ;
    rdfs:domain :ComplianceEvaluation ;
    rdfs:range xsd:dateTime ;
    rdfs:label "evaluation timestamp"@en ;
    rdfs:comment "When the compliance evaluation was performed."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#originalValue
:originalValue rdf:type owl:DatatypeProperty ;
    rdfs:domain :GeographicReference ;
    rdfs:range xsd:string ;
    rdfs:label "original value"@en ;
    rdfs:comment "The original string/URI value as found in the ODRL policy."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#violationSeverity
:violationSeverity rdf:type owl:DatatypeProperty ;
    rdfs:domain :PolicyViolation ;
    rdfs:range xsd:string ;
    rdfs:label "violation severity"@en ;
    rdfs:comment "Severity level: critical, high, medium, low."@en ;
    skos:scopeNote "Extended property"@en .

###  http://example.org/ffdr#violationDescription
:violationDescription rdf:type owl:DatatypeProperty ;
    rdfs:domain :PolicyViolation ;
    rdfs:range xsd:string ;
    rdfs:label "violation description"@en ;
    rdfs:comment "Human-readable description of the violation."@en ;
    skos:scopeNote "Integration property"@en .

###  http://example.org/ffdr#iso3166Alpha2
:iso3166Alpha2 rdf:type owl:DatatypeProperty ;
    rdfs:domain :EUMemberState ;
    rdfs:range xsd:string ;
    rdfs:label "ISO 3166 Alpha-2 code"@en ;
    rdfs:comment "Two-letter country code (e.g., DE, FR, ES)."@en ;
    skos:scopeNote "Integration property"@en .

###  http://example.org/ffdr#iso3166Alpha3
:iso3166Alpha3 rdf:type owl:DatatypeProperty ;
    rdfs:domain :EUMemberState ;
    rdfs:range xsd:string ;
    rdfs:label "ISO 3166 Alpha-3 code"@en ;
    rdfs:comment "Three-letter country code (e.g., DEU, FRA, ESP)."@en ;
    skos:scopeNote "Integration property"@en .

#################################################################
#    Classes
#################################################################

###  http://example.org/ffdr#LocalisationRestriction
:LocalisationRestriction rdf:type owl:Class ;
    rdfs:label "Localisation Restriction"@en ;
    rdfs:comment """A detected geographic constraint in an ODRL policy that restricts where 
    data can be stored, processed, or accessed. May violate Article 4 of Regulation 2018/1807."""@en ;
    skos:definition """Any requirement that data be stored or processed in a specific geographic 
    location, particularly when that location is an EU member state."""@en ;
    skos:scopeNote "Core class: Essential for all FFDR implementations."@en .

###  http://example.org/ffdr#StorageRestriction
:StorageRestriction rdf:type owl:Class ;
    rdfs:subClassOf :LocalisationRestriction ;
    rdfs:label "Storage Restriction"@en ;
    rdfs:comment "Restriction on where data may be physically stored."@en ;
    skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .

###  http://example.org/ffdr#ProcessingRestriction
:ProcessingRestriction rdf:type owl:Class ;
    rdfs:subClassOf :LocalisationRestriction ;
    rdfs:label "Processing Restriction"@en ;
    rdfs:comment "Restriction on where data processing activities may occur."@en ;
    skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .

###  http://example.org/ffdr#AccessRestriction
:AccessRestriction rdf:type owl:Class ;
    rdfs:subClassOf :LocalisationRestriction ;
    rdfs:label "Access Restriction"@en ;
    rdfs:comment "Restriction on who can access data based on geographic location."@en ;
    skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .

###  http://example.org/ffdr#ComplianceEvaluation
:ComplianceEvaluation rdf:type owl:Class ;
    rdfs:subClassOf prov:Activity ;
    rdfs:label "Compliance Evaluation"@en ;
    rdfs:comment """An assessment of whether an ODRL policy complies with Regulation 2018/1807. 
    Records findings, violations, and overall compliance status."""@en ;
    skos:scopeNote "Core class: Essential for representing evaluation results."@en .

###  http://example.org/ffdr#GeographicReference
:GeographicReference rdf:type owl:Class ;
    rdfs:label "Geographic Reference"@en ;
    rdfs:comment """A reference to a geographic location found in an ODRL policy. 
    May be represented as URI, ISO code, or string literal."""@en ;
    skos:scopeNote "Extended class: Use when tracking normalization process from original to canonical form."@en .

###  http://example.org/ffdr#CanonicalLocation
:CanonicalLocation rdf:type owl:Class ;
    rdfs:subClassOf :GeographicReference ;
    rdfs:label "Canonical Location"@en ;
    rdfs:comment "A normalized, standardized representation of a geographic location."@en ;
    skos:scopeNote "Extended class: Use when tracking normalization process from original to canonical form."@en .

###  http://example.org/ffdr#EUMemberState
:EUMemberState rdf:type owl:Class ;
    rdfs:subClassOf :CanonicalLocation ;
    rdfs:label "EU Member State"@en ;
    rdfs:comment "One of the 27 member states of the European Union."@en ;
    skos:scopeNote "Core class: Essential for identifying Article 4 violations."@en .

###  http://example.org/ffdr#PolicyViolation
:PolicyViolation rdf:type owl:Class ;
    rdfs:label "Policy Violation"@en ;
    rdfs:comment """A specific non-compliance instance where an ODRL policy violates 
    Regulation 2018/1807."""@en ;
    skos:scopeNote "Core class: Essential for reporting what regulatory requirement was violated."@en .

###  http://example.org/ffdr#Article4Violation
:Article4Violation rdf:type owl:Class ;
    rdfs:subClassOf :PolicyViolation ;
    rdfs:label "Article 4 Violation"@en ;
    rdfs:comment """Violation of Article 4: Prohibition of data localisation requirements 
    unless justified on public security grounds."""@en ;
    skos:scopeNote "Integration class: Specific subtype linking violations to regulatory articles."@en .

###  http://example.org/ffdr#RegulatoryArticle
:RegulatoryArticle rdf:type owl:Class ;
    rdfs:label "Regulatory Article"@en ;
    rdfs:comment "An article from Regulation 2018/1807."@en ;
    skos:scopeNote "Integration class: Links violations to specific regulatory provisions."@en .

###  http://example.org/ffdr#Justification
:Justification rdf:type owl:Class ;
    rdfs:label "Justification"@en ;
    rdfs:comment """Legal justification for a data localisation requirement. 
    Must be based on public security grounds per Article 4."""@en ;
    skos:scopeNote "Integration class: Use when documenting exemptions under Article 4(1)."@en .

###  http://example.org/ffdr#PublicSecurityJustification
:PublicSecurityJustification rdf:type owl:Class ;
    rdfs:subClassOf :Justification ;
    rdfs:label "Public Security Justification"@en ;
    rdfs:comment """Justification based on public security as defined in Article 52 TFEU: 
    genuine and sufficiently serious threat to fundamental interests of society."""@en ;
    skos:scopeNote "Extended class: Use for detailed documentation of public security exemptions."@en .

#################################################################
#    Individuals (Regulatory Articles)
#################################################################

###  http://example.org/ffdr#Article4
:Article4 rdf:type owl:NamedIndividual ,
                   :RegulatoryArticle ;
    rdfs:label "Article 4 - Prohibition of data localisation requirements"@en ;
    dct:description """Data localisation requirements shall be prohibited, unless they are 
    justified on grounds of public security in compliance with the principle of proportionality."""@en ;
    skos:scopeNote "Core individual: Central regulatory provision for FFDR compliance checking."@en .

###  http://example.org/ffdr#Article5
:Article5 rdf:type owl:NamedIndividual ,
                   :RegulatoryArticle ;
    rdfs:label "Article 5 - Availability of data to competent authorities"@en ;
    dct:description """This Regulation shall not affect the powers of competent authorities 
    to request, or obtain, access to data for the performance of their official duties."""@en ;
    skos:scopeNote "Integration individual: May be relevant for data access restrictions."@en .

#################################################################
#    Annotation Properties for Extended Documentation
#################################################################

###  Regulation References
:regulationReference rdf:type owl:AnnotationProperty ;
    rdfs:label "regulation reference"@en ;
    rdfs:comment "Reference to specific articles/recitals in Regulation 2018/1807."@en .

###  Competency Questions
:competencyQuestion rdf:type owl:AnnotationProperty ;
    rdfs:label "competency question"@en ;
    rdfs:comment "A question this ontology is designed to answer."@en .

#################################################################
#    Ontology Competency Questions (as annotations)
#################################################################

<http://example.org/ffdr> :competencyQuestion """CQ1: Does this ODRL policy contain any geographic 
restrictions on data storage, processing, or access?"""@en ;
    :competencyQuestion """CQ2: Are any detected geographic restrictions related to EU member states?"""@en ;
    :competencyQuestion """CQ3: What is the compliance status of this policy with respect to Article 4 
of Regulation 2018/1807?"""@en ;
    :competencyQuestion """CQ4: Which specific ODRL constraints contain data localisation violations?"""@en ;
    :competencyQuestion """CQ5: Has a detected localisation restriction been justified on public 
security grounds?"""@en ;
    :competencyQuestion """CQ6: What method was used to detect a geographic reference 
(URI matching, ISO code, string matching)?"""@en ;
    :competencyQuestion """CQ7: What is the confidence level of a detected restriction?"""@en ;
    :competencyQuestion """CQ8: What type of restriction was detected (storage/processing/access)?"""@en .

#################################################################
#    Module Usage Guidelines  
#################################################################

:ModuleUsageNote rdf:type owl:AnnotationProperty ;
    rdfs:comment """
    USING THE MODULES:
    
    Core Module Only (Minimal Implementation):
    - Import only: LocalisationRestriction, ComplianceEvaluation, PolicyViolation, EUMemberState, Article4
    - Use restrictionType as string datatype instead of subclasses
    - Sufficient for: Simple yes/no compliance checking
    
    Core + Extended (Recommended for Production):
    - Add: Restriction subclasses, justification tracking, provenance
    - Sufficient for: Detailed reporting, audit trails, data space integration
    
    Full Ontology (Research & Advanced Integration):
    - All classes and properties
    - Sufficient for: SPARQL federation, semantic interoperability, research analysis
    """@en .

#################################################################
#    SHACL Integration Note
#################################################################

:SHACLIntegrationNote rdf:type owl:AnnotationProperty ;
    rdfs:comment """This ontology is designed to work with SHACL shapes that validate 
    ODRL policies. The SHACL validation results (sh:ValidationResult) can be transformed 
    into instances of ffdr:ComplianceEvaluation and ffdr:PolicyViolation."""@en .