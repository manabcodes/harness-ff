@prefix : <https://purl.org/ffdro> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/2001/XMLSchema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix odrl: <http://www.w3.org/ns/odrl/2/> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix vann: <http://purl.org/vocab/vann/> .
@base <https://purl.org/ffdro> .

<https://purl.org/ffdro> rdf:type owl:Ontology ;
                           <https://w3id.org/mod#competencyQuestion> """CQ1: Does this ODRL policy contain any geographic 
restrictions on data storage, processing, or access?"""@en ,
                                               "CQ2: Are any detected geographic restrictions related to EU member states?"@en ,
                                               """CQ3: What is the compliance status of this policy with respect to Article 4 
of Regulation 2018/1807?"""@en ,
                                               "CQ4: Which specific ODRL constraints contain data localisation violations?"@en ,
                                               """CQ5: Has a detected localisation restriction been justified on public 
security grounds?"""@en ,
                                               """CQ6: What method was used to detect a geographic reference 
(URI matching, ISO code, string matching)?"""@en ,
                                               "CQ7: What is the confidence level of a detected restriction?"@en ,
                                               "CQ8: What type of restriction was detected (storage/processing/access)?"@en ;
                           dct:created "2025-11-18"^^xsd:date ;
                           dct:creator "Meem Arafat Manab" ;
                           dct:creator "Victor Rodriguez-Doncel" ;
                           dct:description """An ontology for detecting and representing data localisation restrictions 
    in ODRL policies with respect to EU Regulation 2018/1807 on the free flow of non-personal data."""@en ;
                           dct:title "Free Flow Data Restrictions (FFDR) Ontology"@en ;
                           vann:preferredNamespacePrefix "ffdro" ;
                           vann:preferredNamespaceUri "https://purl.org/ffdro#" ;
                           rdfs:comment """This ontology supports automated compliance checking of data usage policies 
    against Article 4 of Regulation (EU) 2018/1807, which prohibits data localisation requirements 
    unless justified on grounds of public security.
    
    The ontology is organized into three conceptual modules using SKOS Collections:
    - Core Module: Essential classes for basic Article 4 compliance detection (5 classes, 8 properties)
    - Extended Module: Rich metadata for provenance and detailed classification (6 classes, 7 properties)  
    - Integration Module: Links to external vocabularies like ODRL and PROV-O (3 classes, 5 properties)"""@en ;
                           owl:versionInfo "1.0" .

#################################################################
#    Annotation properties
#################################################################

###  https://purl.org/ffdro#ModuleUsageNote
:ModuleUsageNote rdf:type owl:AnnotationProperty ;
                 rdfs:comment """
    USING THE MODULES:
    
    Core Module Only (Minimal Implementation):
    - Import only: LocalisationRestriction, ComplianceEvaluation, PolicyViolation, EUMemberState, Article4
    - Use restrictionType as string datatype instead of subclasses
    - Sufficient for: Simple yes/no compliance checking
    
    Core + Extended (Recommended for Production):
    - Add: Restriction subclasses, justification tracking, provenance
    - Sufficient for: Detailed reporting, audit trails, data space integration
    
    Full Ontology (Research & Advanced Integration):
    - All classes and properties
    - Sufficient for: SPARQL federation, semantic interoperability, research analysis
    """@en .


###  https://purl.org/ffdro#SHACLIntegrationNote
:SHACLIntegrationNote rdf:type owl:AnnotationProperty ;
                      rdfs:comment """This ontology is designed to work with SHACL shapes that validate 
    ODRL policies. The SHACL validation results (sh:ValidationResult) can be transformed 
    into instances of ffdr:ComplianceEvaluation and ffdr:PolicyViolation."""@en .


###  https://purl.org/ffdro#competencyQuestion
<https://w3id.org/mod#competencyQuestion> rdf:type owl:AnnotationProperty ;
                    rdfs:comment "A question this ontology is designed to answer."@en ;
                    rdfs:label "competency question"@en .


###  https://purl.org/ffdro#regulationReference
:regulationReference rdf:type owl:AnnotationProperty ;
                     rdfs:comment "Reference to specific articles/recitals in Regulation 2018/1807."@en ;
                     rdfs:label "regulation reference"@en .


###  http://purl.org/dc/terms/created
dct:created rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/creator
dct:creator rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/description
dct:description rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/title
dct:title rdf:type owl:AnnotationProperty .


###  http://purl.org/vocab/vann/preferredNamespacePrefix
vann:preferredNamespacePrefix rdf:type owl:AnnotationProperty .


###  http://purl.org/vocab/vann/preferredNamespaceUri
vann:preferredNamespaceUri rdf:type owl:AnnotationProperty .


###  http://www.w3.org/2004/02/skos/core#definition
skos:definition rdf:type owl:AnnotationProperty .


###  http://www.w3.org/2004/02/skos/core#member
skos:member rdf:type owl:AnnotationProperty .


###  http://www.w3.org/2004/02/skos/core#note
skos:note rdf:type owl:AnnotationProperty .


###  http://www.w3.org/2004/02/skos/core#prefLabel
skos:prefLabel rdf:type owl:AnnotationProperty .


###  http://www.w3.org/2004/02/skos/core#scopeNote
skos:scopeNote rdf:type owl:AnnotationProperty .


#################################################################
#    Object Properties
#################################################################

###  https://purl.org/ffdro#detectedIn
:detectedIn rdf:type owl:ObjectProperty ;
            rdfs:domain :LocalisationRestriction ;
            rdfs:range odrl:Constraint ;
            rdfs:comment "Links a localisation restriction to the specific ODRL constraint where it was detected."@en ;
            rdfs:label "detected in"@en ;
            skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#evaluatedPolicy
:evaluatedPolicy rdf:type owl:ObjectProperty ;
                 rdfs:domain :ComplianceEvaluation ;
                 rdfs:range odrl:Policy ;
                 rdfs:comment "The ODRL policy that was evaluated for compliance."@en ;
                 rdfs:label "evaluated policy"@en ;
                 skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#foundRestriction
:foundRestriction rdf:type owl:ObjectProperty ;
                  rdfs:domain :ComplianceEvaluation ;
                  rdfs:range :LocalisationRestriction ;
                  rdfs:comment "Links an evaluation to a detected localisation restriction."@en ;
                  rdfs:label "found restriction"@en ;
                  skos:scopeNote "Integration property"@en .


###  https://purl.org/ffdro#foundViolation
:foundViolation rdf:type owl:ObjectProperty ;
                rdfs:domain :ComplianceEvaluation ;
                rdfs:range :PolicyViolation ;
                rdfs:comment "Links an evaluation to a detected policy violation."@en ;
                rdfs:label "found violation"@en ;
                skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#hasJustification
:hasJustification rdf:type owl:ObjectProperty ;
                  rdfs:domain :LocalisationRestriction ;
                  rdfs:range :Justification ;
                  rdfs:comment "Links a restriction to its legal justification (if any)."@en ;
                  rdfs:label "has justification"@en ;
                  skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#normalizedAs
:normalizedAs rdf:type owl:ObjectProperty ;
              rdfs:domain :GeographicReference ;
              rdfs:range :CanonicalLocation ;
              rdfs:comment "Links a geographic reference to its canonical normalized form."@en ;
              rdfs:label "normalized as"@en ;
              skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#restrictsToLocation
:restrictsToLocation rdf:type owl:ObjectProperty ;
                     rdfs:domain :LocalisationRestriction ;
                     rdfs:range :GeographicReference ;
                     rdfs:comment "Indicates the geographic location to which data is restricted."@en ;
                     rdfs:label "restricts to location"@en ;
                     skos:scopeNote "Integration property"@en .


###  https://purl.org/ffdro#restrictsToMemberState
:restrictsToMemberState rdf:type owl:ObjectProperty ;
                        rdfs:subPropertyOf :restrictsToLocation ;
                        rdfs:range :EUMemberState ;
                        rdfs:comment "Indicates restriction to a specific EU member state (Article 4 concern)."@en ;
                        rdfs:label "restricts to member state"@en ;
                        skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#violatesArticle
:violatesArticle rdf:type owl:ObjectProperty ;
                 rdfs:domain :PolicyViolation ;
                 rdfs:range :RegulatoryArticle ;
                 rdfs:comment "Indicates which regulatory article is violated."@en ;
                 rdfs:label "violates article"@en ;
                 skos:scopeNote "Core property"@en .


#################################################################
#    Data properties
#################################################################

###  https://purl.org/ffdro#complianceStatus
:complianceStatus rdf:type owl:DatatypeProperty ;
                  rdfs:domain :ComplianceEvaluation ;
                  rdfs:range xsd:string ;
                  rdfs:comment "Overall compliance status: compliant, non-compliant, or requires-review."@en ;
                  rdfs:label "compliance status"@en ;
                  skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#confidenceScore
:confidenceScore rdf:type owl:DatatypeProperty ;
                 rdfs:range xsd:decimal ;
                 rdfs:comment "Confidence level of the detection (0.0 to 1.0)."@en ;
                 rdfs:label "confidence score"@en ;
                 skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#detectionMethod
:detectionMethod rdf:type owl:DatatypeProperty ;
                 rdfs:range xsd:string ;
                 rdfs:comment "Method used to detect the restriction: uri-match, iso-code, string-match, fuzzy."@en ;
                 rdfs:label "detection method"@en ;
                 skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#evaluationTimestamp
:evaluationTimestamp rdf:type owl:DatatypeProperty ;
                     rdfs:domain :ComplianceEvaluation ;
                     rdfs:range xsd:dateTime ;
                     rdfs:comment "When the compliance evaluation was performed."@en ;
                     rdfs:label "evaluation timestamp"@en ;
                     skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#iso3166Alpha2
:iso3166Alpha2 rdf:type owl:DatatypeProperty ;
               rdfs:domain :EUMemberState ;
               rdfs:range xsd:string ;
               rdfs:comment "Two-letter country code (e.g., DE, FR, ES)."@en ;
               rdfs:label "ISO 3166 Alpha-2 code"@en ;
               skos:scopeNote "Integration property"@en .


###  https://purl.org/ffdro#iso3166Alpha3
:iso3166Alpha3 rdf:type owl:DatatypeProperty ;
               rdfs:domain :EUMemberState ;
               rdfs:range xsd:string ;
               rdfs:comment "Three-letter country code (e.g., DEU, FRA, ESP)."@en ;
               rdfs:label "ISO 3166 Alpha-3 code"@en ;
               skos:scopeNote "Integration property"@en .


###  https://purl.org/ffdro#justificationRequired
:justificationRequired rdf:type owl:DatatypeProperty ;
                       rdfs:domain :LocalisationRestriction ;
                       rdfs:range xsd:boolean ;
                       rdfs:comment "Boolean flag indicating if public security justification is required."@en ;
                       rdfs:label "justification required"@en ;
                       skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#originalValue
:originalValue rdf:type owl:DatatypeProperty ;
               rdfs:domain :GeographicReference ;
               rdfs:range xsd:string ;
               rdfs:comment "The original string/URI value as found in the ODRL policy."@en ;
               rdfs:label "original value"@en ;
               skos:scopeNote "Extended property"@en .


###  https://purl.org/ffdro#restrictionType
:restrictionType rdf:type owl:DatatypeProperty ;
                 rdfs:domain :LocalisationRestriction ;
                 rdfs:range xsd:string ;
                 rdfs:comment "Type of restriction: storage, processing, or access."@en ;
                 rdfs:label "restriction type"@en ;
                 skos:scopeNote "Core property"@en .


###  https://purl.org/ffdro#violationDescription
:violationDescription rdf:type owl:DatatypeProperty ;
                      rdfs:domain :PolicyViolation ;
                      rdfs:range xsd:string ;
                      rdfs:comment "Human-readable description of the violation."@en ;
                      rdfs:label "violation description"@en ;
                      skos:scopeNote "Integration property"@en .


###  https://purl.org/ffdro#violationSeverity
:violationSeverity rdf:type owl:DatatypeProperty ;
                   rdfs:domain :PolicyViolation ;
                   rdfs:range xsd:string ;
                   rdfs:comment "Severity level: critical, high, medium, low."@en ;
                   rdfs:label "violation severity"@en ;
                   skos:scopeNote "Extended property"@en .


#################################################################
#    Classes
#################################################################

###  https://purl.org/ffdro#AccessRestriction
:AccessRestriction rdf:type owl:Class ;
                   rdfs:subClassOf :LocalisationRestriction ;
                   rdfs:comment "Restriction on who can access data based on geographic location."@en ;
                   rdfs:label "Access Restriction"@en ;
                   skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .


###  https://purl.org/ffdro#Article4Violation
:Article4Violation rdf:type owl:Class ;
                   rdfs:subClassOf :PolicyViolation ;
                   rdfs:comment """Violation of Article 4: Prohibition of data localisation requirements 
    unless justified on public security grounds."""@en ;
                   rdfs:label "Article 4 Violation"@en ;
                   skos:scopeNote "Integration class: Specific subtype linking violations to regulatory articles."@en .


###  https://purl.org/ffdro#CanonicalLocation
:CanonicalLocation rdf:type owl:Class ;
                   rdfs:subClassOf :GeographicReference ;
                   rdfs:comment "A normalized, standardized representation of a geographic location."@en ;
                   rdfs:label "Canonical Location"@en ;
                   skos:scopeNote "Extended class: Use when tracking normalization process from original to canonical form."@en .


###  https://purl.org/ffdro#ComplianceEvaluation
:ComplianceEvaluation rdf:type owl:Class ;
                      rdfs:subClassOf prov:Activity ;
                      rdfs:comment """An assessment of whether an ODRL policy complies with Regulation 2018/1807. 
    Records findings, violations, and overall compliance status."""@en ;
                      rdfs:label "Compliance Evaluation"@en ;
                      skos:scopeNote "Core class: Essential for representing evaluation results."@en .


###  https://purl.org/ffdro#EUMemberState
:EUMemberState rdf:type owl:Class ;
               rdfs:subClassOf :CanonicalLocation ;
               rdfs:comment "One of the 27 member states of the European Union."@en ;
               rdfs:label "EU Member State"@en ;
               skos:scopeNote "Core class: Essential for identifying Article 4 violations."@en .


###  https://purl.org/ffdro#GeographicReference
:GeographicReference rdf:type owl:Class ;
                     rdfs:comment """A reference to a geographic location found in an ODRL policy. 
    May be represented as URI, ISO code, or string literal."""@en ;
                     rdfs:label "Geographic Reference"@en ;
                     skos:scopeNote "Extended class: Use when tracking normalization process from original to canonical form."@en .


###  https://purl.org/ffdro#Justification
:Justification rdf:type owl:Class ;
               rdfs:comment """Legal justification for a data localisation requirement. 
    Must be based on public security grounds per Article 4."""@en ;
               rdfs:label "Justification"@en ;
               skos:scopeNote "Integration class: Use when documenting exemptions under Article 4(1)."@en .


###  https://purl.org/ffdro#LocalisationRestriction
:LocalisationRestriction rdf:type owl:Class ;
                         rdfs:comment """A detected geographic constraint in an ODRL policy that restricts where 
    data can be stored, processed, or accessed. May violate Article 4 of Regulation 2018/1807."""@en ;
                         rdfs:label "Localisation Restriction"@en ;
                         skos:definition """Any requirement that data be stored or processed in a specific geographic 
    location, particularly when that location is an EU member state."""@en ;
                         skos:scopeNote "Core class: Essential for all FFDR implementations."@en .


###  https://purl.org/ffdro#PolicyViolation
:PolicyViolation rdf:type owl:Class ;
                 rdfs:comment """A specific non-compliance instance where an ODRL policy violates 
    Regulation 2018/1807."""@en ;
                 rdfs:label "Policy Violation"@en ;
                 skos:scopeNote "Core class: Essential for reporting what regulatory requirement was violated."@en .


###  https://purl.org/ffdro#ProcessingRestriction
:ProcessingRestriction rdf:type owl:Class ;
                       rdfs:subClassOf :LocalisationRestriction ;
                       rdfs:comment "Restriction on where data processing activities may occur."@en ;
                       rdfs:label "Processing Restriction"@en ;
                       skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .


###  https://purl.org/ffdro#PublicSecurityJustification
:PublicSecurityJustification rdf:type owl:Class ;
                             rdfs:subClassOf :Justification ;
                             rdfs:comment """Justification based on public security as defined in Article 52 TFEU: 
    genuine and sufficiently serious threat to fundamental interests of society."""@en ;
                             rdfs:label "Public Security Justification"@en ;
                             skos:scopeNote "Extended class: Use for detailed documentation of public security exemptions."@en .


###  https://purl.org/ffdro#RegulatoryArticle
:RegulatoryArticle rdf:type owl:Class ;
                   rdfs:comment "An article from Regulation 2018/1807."@en ;
                   rdfs:label "Regulatory Article"@en ;
                   skos:scopeNote "Integration class: Links violations to specific regulatory provisions."@en .


###  https://purl.org/ffdro#StorageRestriction
:StorageRestriction rdf:type owl:Class ;
                    rdfs:subClassOf :LocalisationRestriction ;
                    rdfs:comment "Restriction on where data may be physically stored."@en ;
                    rdfs:label "Storage Restriction"@en ;
                    skos:scopeNote "Extended class: Use for detailed classification of restriction types."@en .


###  http://www.w3.org/2004/02/skos/core#Collection
skos:Collection rdf:type owl:Class .


###  http://www.w3.org/ns/odrl/2/Constraint
odrl:Constraint rdf:type owl:Class .


###  http://www.w3.org/ns/odrl/2/Policy
odrl:Policy rdf:type owl:Class .


###  http://www.w3.org/ns/prov#Activity
prov:Activity rdf:type owl:Class .


#################################################################
#    Individuals
#################################################################

###  https://purl.org/ffdro#Article4
:Article4 rdf:type owl:NamedIndividual ,
                   :RegulatoryArticle ;
          dct:description """Data localisation requirements shall be prohibited, unless they are 
    justified on grounds of public security in compliance with the principle of proportionality."""@en ;
          rdfs:label "Article 4 - Prohibition of data localisation requirements"@en ;
          skos:scopeNote "Core individual: Central regulatory provision for FFDR compliance checking."@en .


###  https://purl.org/ffdro#Article5
:Article5 rdf:type owl:NamedIndividual ,
                   :RegulatoryArticle ;
          dct:description """This Regulation shall not affect the powers of competent authorities 
    to request, or obtain, access to data for the performance of their official duties."""@en ;
          rdfs:label "Article 5 - Availability of data to competent authorities"@en ;
          skos:scopeNote "Integration individual: May be relevant for data access restrictions."@en .


###  https://purl.org/ffdro#CoreModule
:CoreModule rdf:type owl:NamedIndividual ,
                     skos:Collection ;
            skos:definition """Minimal set of classes and properties required for basic Article 4 
    compliance detection. This module provides sufficient functionality for simple deployment 
    scenarios where only violation detection is needed. Consists of 5 classes and 8 properties."""@en ;
            skos:member :ComplianceEvaluation ,
                        :EUMemberState ,
                        :LocalisationRestriction ,
                        :PolicyViolation ,
                        :RegulatoryArticle ,        # ← ADDED THIS
                        :complianceStatus ,
                        :detectedIn ,
                        :evaluatedPolicy ,
                        :foundViolation ,
                        :justificationRequired ,
                        :restrictionType ,
                        :restrictsToMemberState ,
                        :violatesArticle ;
            skos:note """Use Case: Quick compliance checks on ODRL policies in data portals. 
    Detects whether a policy restricts data to specific EU member states."""@en ;
            skos:prefLabel "Core FFDR Module"@en .


###  https://purl.org/ffdro#ExtendedModule
:ExtendedModule rdf:type owl:NamedIndividual ,
                         skos:Collection ;
                skos:definition """Additional classes supporting rich provenance tracking, detailed 
    restriction type classification, and justification documentation. Enables comprehensive 
    reporting and audit trails. Consists of 6 classes and 7 properties."""@en ;
                skos:member :AccessRestriction ,
                            :CanonicalLocation ,
                            :GeographicReference ,
                            :ProcessingRestriction ,
                            :PublicSecurityJustification ,
                            :StorageRestriction ,
                            :confidenceScore ,
                            :detectionMethod ,
                            :evaluationTimestamp ,
                            :hasJustification ,
                            :normalizedAs ,
                            :originalValue ,
                            :violationSeverity ;
                skos:note """Use Case: Production data spaces requiring detailed compliance reports, 
    provenance tracking, and integration with governance frameworks (GAIA-X, IDSA)."""@en ;
                skos:prefLabel "Extended FFDR Module"@en .


###  https://purl.org/ffdro#IntegrationModule
:IntegrationModule rdf:type owl:NamedIndividual ,
                            skos:Collection ;
                   skos:definition """Classes and properties for linking FFDR to external vocabularies 
    (ODRL, PROV-O, DCT) and supporting interoperability with broader semantic web 
    infrastructure. Consists of 2 classes, 2 named individuals, and 5 properties."""@en ;
                   skos:member :Article4 ,              # ← ADDED
                               :Article5 ,              # ← ADDED
                               :Article4Violation ,
                               :Justification ,
                               :foundRestriction ,
                               :iso3166Alpha2 ,
                               :iso3166Alpha3 ,
                               :restrictsToLocation ,
                               :violationDescription ;
                   skos:note """Use Case: Linking compliance evaluations to policy documents, integrating 
    with existing provenance systems, and enabling SPARQL federation across data catalogs."""@en ;
                   skos:prefLabel "Integration Module"@en .


###  Generated by the OWL API (version 4.5.9.2019-02-01T07:24:44Z) https://github.com/owlcs/owlapi
